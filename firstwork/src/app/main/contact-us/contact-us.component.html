<section id="contact-us" class="bg-black">
    <div
        class="container mx-auto flex flex-col items-center justify-center min-h-[580px] p-4 sm:p-8 md:p-16">
        
        <ng-template #loadingTemplate>
            <div class="flex justify-center items-center h-full">
              <div class="dotted-loader"></div>
            </div>
          </ng-template>

        <ng-container *ngIf="!isLoading; else loadingTemplate">
            <div *ngIf="ticketStatus === 'NOTSENT'"
                class="flex flex-col items-center">

                <div
                    class="flex flex-col sm:flex-row gap-3 mx-auto text-center">
                    <span
                        class="text-5xl text-white font-extrabold">Залиште</span>
                    <span
                        class="text-5xl text-[#3EF8F5] font-extrabold">заявку</span>
                </div>
                <h4 class="text-base md:text-xl my-4 text-white text-center">
                    Залиште свої контактні дані, і ми безкоштовно підберемо авто
                    під ваші вимоги та бюджет
                </h4>

                <form class="flex flex-col w-full sm:w-2/3 md:w-[40vw] xl:w-2/5"
                    [formGroup]="contactUsForm" (ngSubmit)="onSubmit()">

                    <!-- Name Field -->
                    <label class="text-white" for="name">Ім'я</label>
                    <input
                        class="w-full rounded-md py-3 px-4 my-2 text-gray-100 bg-gray-800 border border-cyan-500 focus:drop-shadow-[0_0_8px_#3ef8f5] transition-all outline-none"
                        placeholder="Іван" id="name" type="text"
                        formControlName="name">
                    <div class="text-red-500" [@errorAnimation]
                        *ngIf="nameControl && nameControl.errors?.['required'] && (nameControl.touched || nameControl.dirty)">
                        Ім'я не може бути пустим
                    </div>
                    <div class="text-red-500" [@errorAnimation]
                        *ngIf="nameControl && (nameControl.errors?.['minlength'] || nameControl.errors?.['maxlength']) && (nameControl.touched || nameControl.dirty)">
                        Ім'я не може бути коротшим за 2 символи та довшим за 32
                    </div>

                    <!-- Phone Number Field -->
                    <label class="text-white" for="phoneNumber">Номер
                        телефону</label>
                    <input
                        class="w-full rounded-md py-3 px-4 my-2 text-gray-100 bg-gray-800 border border-cyan-500 focus:drop-shadow-[0_0_8px_#3ef8f5] transition-all outline-none"
                        placeholder="+380689999999" id="phoneNumber" type="text"
                        formControlName="phoneNumber">
                    <div class="text-red-500" [@errorAnimation]
                        *ngIf="phoneControl && phoneControl.errors?.['required'] && (phoneControl.touched || phoneControl.dirty)">
                        Введіть номер телефону
                    </div>
                    <div class="text-red-500" [@errorAnimation]
                        *ngIf="phoneControl && phoneControl.errors?.['pattern'] && (!phoneControl.touched || phoneControl.dirty)">
                        Введіть валідний номер телефону (Наприклад:
                        +380689999999)
                    </div>

                    <div class="mx-auto">
                        <button
                            class="text-[#3EF8F5] hover:text-white font-semibold w-40 sm:w-48 md:w-56 mt-4 h-10 border-2 border-cyan-500 rounded-full cursor-pointer hover:bg-cyan-500 transition-colors"
                            type="submit" [disabled]="!contactUsForm.valid">
                            Відправити
                        </button>
                    </div>
                </form>
            </div>

            <!-- Ticket received successfully -->
            <div *ngIf="ticketStatus === 'RECIEVED'" @swapAnimation
                class="flex flex-col items-center justify-center">
                <svg width="180px" height="180px" viewBox="0 0 24 24"
                    fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.5 12.5L10.5 14.5L15.5 9.5" stroke="#3EF8F5"
                        stroke-width="1.5" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    <path
                        d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7"
                        stroke="#3EF8F5" stroke-width="1.5"
                        stroke-linecap="round"></path>
                </svg>
                <span
                    class="text-5xl my-6 text-white font-extrabold text-center">Заявку
                    залишено!</span>
                <h4 class="text-xl my-4 text-white text-center">Невдовзі наш
                    спеціаліст зв'яжеться з вами</h4>
            </div>

            <!-- Failed to send ticket -->
            <div *ngIf="ticketStatus === 'NOTRECIEVED'" @swapAnimation
                class="flex flex-col items-center justify-center">
                <svg width="200px" height="200px" viewBox="0 0 24 24"
                    fill="none" xmlns="http://www.w3.org/2000/svg"
                    stroke="#ff0000">
                    <path d="M14.5 9.50002L9.5 14.5M9.49998 9.5L14.5 14.5"
                        stroke="#ff0000" stroke-width="1.5"
                        stroke-linecap="round"></path>
                    <path
                        d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7"
                        stroke="#ff0000" stroke-width="1.5"
                        stroke-linecap="round"></path>
                </svg>
                <span
                    class="text-3xl sm:text-5xl my-6 text-white font-extrabold text-center">Не
                    вдалось залишити заявку</span>
                <h4 class="text-xl my-4 text-white text-center">
                    Зараз ми не змогли надіслати вашу заявку, але ви завжди
                    можете зателефонувати нам!
                </h4>
                <div class="flex justify-center flex-row gap-2">
                    <div>
                        <svg class="w-6 h-6" viewBox="0 0 22 22" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M20.8881 15.9201V18.9201C20.8892 19.1986 20.8322 19.4743 20.7206 19.7294C20.6091 19.9846 20.4454 20.2137 20.2402 20.402C20.035 20.5902 19.7927 20.7336 19.5289 20.8228C19.265 20.912 18.9855 20.9452 18.7081 20.9201C15.631 20.5857 12.6751 19.5342 10.0781 17.8501C7.66194 16.3148 5.61345 14.2663 4.07812 11.8501C2.38809 9.2413 1.33636 6.27109 1.00812 3.1801C0.983127 2.90356 1.01599 2.62486 1.10462 2.36172C1.19324 2.09859 1.33569 1.85679 1.52288 1.65172C1.71008 1.44665 1.91965 1.28636 2.15212 1.18432C2.38458 1.08227 2.63538 1.04063 2.88541 1.06202C5.32475 1.14309 7.54556 2.13351 9.48739 3.80307C11.5778 5.73017 13.3429 8.15669 14.6971 10.8959C14.8849 11.3465 15.0537 11.8151 15.1992 12.2987C15.3446 12.7823 15.459 13.2742 15.5411 13.7696C15.6188 14.2662 15.6685 14.7653 15.6891 15.266C15.6891 15.266 15.6891 15.266 15.6891 15.266H20.8881Z"
                                fill="#00A1E8"></path>
                        </svg>
                    </div>
                    <div class="flex items-center">
                        <a href="tel:+380688888888"
                            class="text-[#3EF8F5] hover:text-white font-semibold">+38
                            (068) 888 88 88</a>
                    </div>
                </div>
            </div>
        </ng-container>
    </div>
</section>
